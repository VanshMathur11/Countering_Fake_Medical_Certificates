import json

import web3 as web3
from web3 import Web3

ganache_url = "HTTP://127.0.0.1:7545"
web3 = Web3(Web3.HTTPProvider(ganache_url))

web3.eth.defaultAccount=web3.eth.accounts[0]
print(web3.isConnected())
abi=json.loads('[{"inputs":[{"internalType":"string","name":"cid","type":"string"}],"name":"Check1","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"cid","type":"string"}],"name":"Check2","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"slipno","type":"string"}],"name":"Check3","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"did","type":"string"},{"internalType":"string","name":"d_name","type":"string"}],"name":"DoctorRegistration","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"slipno","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"string","name":"did","type":"string"},{"internalType":"string","name":"dname","type":"string"},{"internalType":"string","name":"pid","type":"string"},{"internalType":"string","name":"pname","type":"string"},{"internalType":"string","name":"date","type":"string"},{"internalType":"string","name":"address1","type":"string"}],"name":"MedicalCertificate","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"pid","type":"string"},{"internalType":"string","name":"p_name","type":"string"},{"internalType":"uint256","name":"adhaar_no","type":"uint256"}],"name":"PatientRegistration","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"certificates","outputs":[{"internalType":"string","name":"slipno","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"string","name":"did","type":"string"},{"internalType":"string","name":"dname","type":"string"},{"internalType":"string","name":"pid","type":"string"},{"internalType":"string","name":"pname","type":"string"},{"internalType":"string","name":"date","type":"string"},{"internalType":"string","name":"address1","type":"string"},{"internalType":"bool","name":"exist","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"certificates2","outputs":[{"internalType":"string","name":"slipno","type":"string"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"string","name":"did","type":"string"},{"internalType":"string","name":"dname","type":"string"},{"internalType":"string","name":"pid","type":"string"},{"internalType":"string","name":"pname","type":"string"},{"internalType":"string","name":"date","type":"string"},{"internalType":"string","name":"address1","type":"string"},{"internalType":"bool","name":"exist","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"doctors","outputs":[{"internalType":"string","name":"did","type":"string"},{"internalType":"string","name":"d_name","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"}],"name":"patients","outputs":[{"internalType":"string","name":"pid","type":"string"},{"internalType":"string","name":"p_name","type":"string"},{"internalType":"uint256","name":"adhaar_no","type":"uint256"}],"stateMutability":"view","type":"function"}]')

bytecode= '0x608060405234801561001057600080fd5b5061200c806100206000396000f3fe608060405234801561001057600080fd5b506004361061009e5760003560e01c8063705b865b11610066578063705b865b1461016c578063765d196e146101a45780638f2b91ea146101d4578063c6009d841461020c578063e184d0381461023e5761009e565b806305c35ce5146100a3578063095ac15c146100d45780632532692d146100f057806338e11908146101205780636177b19a1461013c575b600080fd5b6100bd60048036038101906100b89190611781565b61025a565b6040516100cb929190611849565b60405180910390f35b6100ee60048036038101906100e99190611880565b6103a4565b005b61010a60048036038101906101059190611781565b61040a565b60405161011791906118f8565b60405180910390f35b61013a60048036038101906101359190611950565b61058a565b005b61015660048036038101906101519190611781565b610601565b60405161016391906118f8565b60405180910390f35b61018660048036038101906101819190611781565b610781565b60405161019b999897969594939291906119f6565b60405180910390f35b6101be60048036038101906101b99190611781565b610c32565b6040516101cb91906118f8565b60405180910390f35b6101ee60048036038101906101e99190611781565b610db2565b604051610203999897969594939291906119f6565b60405180910390f35b61022660048036038101906102219190611781565b611263565b60405161023593929190611aca565b60405180910390f35b61025860048036038101906102539190611b0f565b6113b3565b005b60008180516020810182018051848252602083016020850120818352809550505050505060009150905080600001805461029390611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546102bf90611cd4565b801561030c5780601f106102e15761010080835404028352916020019161030c565b820191906000526020600020905b8154815290600101906020018083116102ef57829003601f168201915b50505050509080600101805461032190611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461034d90611cd4565b801561039a5780601f1061036f5761010080835404028352916020019161039a565b820191906000526020600020905b81548152906001019060200180831161037d57829003601f168201915b5050505050905082565b6040518060400160405280838152602001828152506000836040516103c99190611d41565b908152602001604051809103902060008201518160000190816103ec9190611f04565b5060208201518160010190816104029190611f04565b509050505050565b6060600082905060008151141580156104555750600115156003846040516104329190611d41565b908152602001604051809103902060080160009054906101000a900460ff161515145b1561054b576001151560038460405161046e9190611d41565b908152602001604051809103902060080160009054906101000a900460ff1615151461049957600080fd5b6003836040516104a99190611d41565b908152602001604051809103902060010180546104c590611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546104f190611cd4565b801561053e5780601f106105135761010080835404028352916020019161053e565b820191906000526020600020905b81548152906001019060200180831161052157829003601f168201915b5050505050915050610585565b6040518060400160405280600181526020017f30000000000000000000000000000000000000000000000000000000000000008152509150505b919050565b6040518060600160405280848152602001838152602001828152506001846040516105b59190611d41565b908152602001604051809103902060008201518160000190816105d89190611f04565b5060208201518160010190816105ee9190611f04565b5060408201518160020155905050505050565b60606000829050600081511415801561064c5750600115156002846040516106299190611d41565b908152602001604051809103902060080160009054906101000a900460ff161515145b1561074257600115156002846040516106659190611d41565b908152602001604051809103902060080160009054906101000a900460ff1615151461069057600080fd5b6002836040516106a09190611d41565b908152602001604051809103902060060180546106bc90611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546106e890611cd4565b80156107355780601f1061070a57610100808354040283529160200191610735565b820191906000526020600020905b81548152906001019060200180831161071857829003601f168201915b505050505091505061077c565b6040518060400160405280600181526020017f30000000000000000000000000000000000000000000000000000000000000008152509150505b919050565b6003818051602081018201805184825260208301602085012081835280955050505050506000915090508060000180546107ba90611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546107e690611cd4565b80156108335780601f1061080857610100808354040283529160200191610833565b820191906000526020600020905b81548152906001019060200180831161081657829003601f168201915b50505050509080600101805461084890611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461087490611cd4565b80156108c15780601f10610896576101008083540402835291602001916108c1565b820191906000526020600020905b8154815290600101906020018083116108a457829003601f168201915b5050505050908060020180546108d690611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461090290611cd4565b801561094f5780601f106109245761010080835404028352916020019161094f565b820191906000526020600020905b81548152906001019060200180831161093257829003601f168201915b50505050509080600301805461096490611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461099090611cd4565b80156109dd5780601f106109b2576101008083540402835291602001916109dd565b820191906000526020600020905b8154815290600101906020018083116109c057829003601f168201915b5050505050908060040180546109f290611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610a1e90611cd4565b8015610a6b5780601f10610a4057610100808354040283529160200191610a6b565b820191906000526020600020905b815481529060010190602001808311610a4e57829003601f168201915b505050505090806005018054610a8090611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610aac90611cd4565b8015610af95780601f10610ace57610100808354040283529160200191610af9565b820191906000526020600020905b815481529060010190602001808311610adc57829003601f168201915b505050505090806006018054610b0e90611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610b3a90611cd4565b8015610b875780601f10610b5c57610100808354040283529160200191610b87565b820191906000526020600020905b815481529060010190602001808311610b6a57829003601f168201915b505050505090806007018054610b9c90611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610bc890611cd4565b8015610c155780601f10610bea57610100808354040283529160200191610c15565b820191906000526020600020905b815481529060010190602001808311610bf857829003601f168201915b5050505050908060080160009054906101000a900460ff16905089565b606060008290506000815114158015610c7d575060011515600284604051610c5a9190611d41565b908152602001604051809103902060080160009054906101000a900460ff161515145b15610d735760011515600284604051610c969190611d41565b908152602001604051809103902060080160009054906101000a900460ff16151514610cc157600080fd5b600283604051610cd19190611d41565b90815260200160405180910390206005018054610ced90611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610d1990611cd4565b8015610d665780601f10610d3b57610100808354040283529160200191610d66565b820191906000526020600020905b815481529060010190602001808311610d4957829003601f168201915b5050505050915050610dad565b6040518060400160405280600181526020017f30000000000000000000000000000000000000000000000000000000000000008152509150505b919050565b600281805160208101820180518482526020830160208501208183528095505050505050600091509050806000018054610deb90611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610e1790611cd4565b8015610e645780601f10610e3957610100808354040283529160200191610e64565b820191906000526020600020905b815481529060010190602001808311610e4757829003601f168201915b505050505090806001018054610e7990611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610ea590611cd4565b8015610ef25780601f10610ec757610100808354040283529160200191610ef2565b820191906000526020600020905b815481529060010190602001808311610ed557829003601f168201915b505050505090806002018054610f0790611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610f3390611cd4565b8015610f805780601f10610f5557610100808354040283529160200191610f80565b820191906000526020600020905b815481529060010190602001808311610f6357829003601f168201915b505050505090806003018054610f9590611cd4565b80601f0160208091040260200160405190810160405280929190818152602001828054610fc190611cd4565b801561100e5780601f10610fe35761010080835404028352916020019161100e565b820191906000526020600020905b815481529060010190602001808311610ff157829003601f168201915b50505050509080600401805461102390611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461104f90611cd4565b801561109c5780601f106110715761010080835404028352916020019161109c565b820191906000526020600020905b81548152906001019060200180831161107f57829003601f168201915b5050505050908060050180546110b190611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546110dd90611cd4565b801561112a5780601f106110ff5761010080835404028352916020019161112a565b820191906000526020600020905b81548152906001019060200180831161110d57829003601f168201915b50505050509080600601805461113f90611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461116b90611cd4565b80156111b85780601f1061118d576101008083540402835291602001916111b8565b820191906000526020600020905b81548152906001019060200180831161119b57829003601f168201915b5050505050908060070180546111cd90611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546111f990611cd4565b80156112465780601f1061121b57610100808354040283529160200191611246565b820191906000526020600020905b81548152906001019060200180831161122957829003601f168201915b5050505050908060080160009054906101000a900460ff16905089565b60018180516020810182018051848252602083016020850120818352809550505050505060009150905080600001805461129c90611cd4565b80601f01602080910402602001604051908101604052809291908181526020018280546112c890611cd4565b80156113155780601f106112ea57610100808354040283529160200191611315565b820191906000526020600020905b8154815290600101906020018083116112f857829003601f168201915b50505050509080600101805461132a90611cd4565b80601f016020809104026020016040519081016040528092919081815260200182805461135690611cd4565b80156113a35780601f10611378576101008083540402835291602001916113a3565b820191906000526020600020905b81548152906001019060200180831161138657829003601f168201915b5050505050908060020154905083565b604051806101200160405280898152602001888152602001878152602001868152602001858152602001848152602001838152602001828152602001600115158152506002886040516114069190611d41565b908152602001604051809103902060008201518160000190816114299190611f04565b50602082015181600101908161143f9190611f04565b5060408201518160020190816114559190611f04565b50606082015181600301908161146b9190611f04565b5060808201518160040190816114819190611f04565b5060a08201518160050190816114979190611f04565b5060c08201518160060190816114ad9190611f04565b5060e08201518160070190816114c39190611f04565b506101008201518160080160006101000a81548160ff0219169083151502179055509050506040518061012001604052808981526020018881526020018781526020018681526020018581526020018481526020018381526020018281526020016001151581525060038960405161153b9190611d41565b9081526020016040518091039020600082015181600001908161155e9190611f04565b5060208201518160010190816115749190611f04565b50604082015181600201908161158a9190611f04565b5060608201518160030190816115a09190611f04565b5060808201518160040190816115b69190611f04565b5060a08201518160050190816115cc9190611f04565b5060c08201518160060190816115e29190611f04565b5060e08201518160070190816115f89190611f04565b506101008201518160080160006101000a81548160ff0219169083151502179055509050505050505050505050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b61168e82611645565b810181811067ffffffffffffffff821117156116ad576116ac611656565b5b80604052505050565b60006116c0611627565b90506116cc8282611685565b919050565b600067ffffffffffffffff8211156116ec576116eb611656565b5b6116f582611645565b9050602081019050919050565b82818337600083830152505050565b600061172461171f846116d1565b6116b6565b9050828152602081018484840111156117405761173f611640565b5b61174b848285611702565b509392505050565b600082601f8301126117685761176761163b565b5b8135611778848260208601611711565b91505092915050565b60006020828403121561179757611796611631565b5b600082013567ffffffffffffffff8111156117b5576117b4611636565b5b6117c184828501611753565b91505092915050565b600081519050919050565b600082825260208201905092915050565b60005b838110156118045780820151818401526020810190506117e9565b60008484015250505050565b600061181b826117ca565b61182581856117d5565b93506118358185602086016117e6565b61183e81611645565b840191505092915050565b600060408201905081810360008301526118638185611810565b905081810360208301526118778184611810565b90509392505050565b6000806040838503121561189757611896611631565b5b600083013567ffffffffffffffff8111156118b5576118b4611636565b5b6118c185828601611753565b925050602083013567ffffffffffffffff8111156118e2576118e1611636565b5b6118ee85828601611753565b9150509250929050565b600060208201905081810360008301526119128184611810565b905092915050565b6000819050919050565b61192d8161191a565b811461193857600080fd5b50565b60008135905061194a81611924565b92915050565b60008060006060848603121561196957611968611631565b5b600084013567ffffffffffffffff81111561198757611986611636565b5b61199386828701611753565b935050602084013567ffffffffffffffff8111156119b4576119b3611636565b5b6119c086828701611753565b92505060406119d18682870161193b565b9150509250925092565b60008115159050919050565b6119f0816119db565b82525050565b6000610120820190508181036000830152611a11818c611810565b90508181036020830152611a25818b611810565b90508181036040830152611a39818a611810565b90508181036060830152611a4d8189611810565b90508181036080830152611a618188611810565b905081810360a0830152611a758187611810565b905081810360c0830152611a898186611810565b905081810360e0830152611a9d8185611810565b9050611aad6101008301846119e7565b9a9950505050505050505050565b611ac48161191a565b82525050565b60006060820190508181036000830152611ae48186611810565b90508181036020830152611af88185611810565b9050611b076040830184611abb565b949350505050565b600080600080600080600080610100898b031215611b3057611b2f611631565b5b600089013567ffffffffffffffff811115611b4e57611b4d611636565b5b611b5a8b828c01611753565b985050602089013567ffffffffffffffff811115611b7b57611b7a611636565b5b611b878b828c01611753565b975050604089013567ffffffffffffffff811115611ba857611ba7611636565b5b611bb48b828c01611753565b965050606089013567ffffffffffffffff811115611bd557611bd4611636565b5b611be18b828c01611753565b955050608089013567ffffffffffffffff811115611c0257611c01611636565b5b611c0e8b828c01611753565b94505060a089013567ffffffffffffffff811115611c2f57611c2e611636565b5b611c3b8b828c01611753565b93505060c089013567ffffffffffffffff811115611c5c57611c5b611636565b5b611c688b828c01611753565b92505060e089013567ffffffffffffffff811115611c8957611c88611636565b5b611c958b828c01611753565b9150509295985092959890939650565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680611cec57607f821691505b602082108103611cff57611cfe611ca5565b5b50919050565b600081905092915050565b6000611d1b826117ca565b611d258185611d05565b9350611d358185602086016117e6565b80840191505092915050565b6000611d4d8284611d10565b915081905092915050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302611dba7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82611d7d565b611dc48683611d7d565b95508019841693508086168417925050509392505050565b6000819050919050565b6000611e01611dfc611df78461191a565b611ddc565b61191a565b9050919050565b6000819050919050565b611e1b83611de6565b611e2f611e2782611e08565b848454611d8a565b825550505050565b600090565b611e44611e37565b611e4f818484611e12565b505050565b5b81811015611e7357611e68600082611e3c565b600181019050611e55565b5050565b601f821115611eb857611e8981611d58565b611e9284611d6d565b81016020851015611ea1578190505b611eb5611ead85611d6d565b830182611e54565b50505b505050565b600082821c905092915050565b6000611edb60001984600802611ebd565b1980831691505092915050565b6000611ef48383611eca565b9150826002028217905092915050565b611f0d826117ca565b67ffffffffffffffff811115611f2657611f25611656565b5b611f308254611cd4565b611f3b828285611e77565b600060209050601f831160018114611f6e5760008415611f5c578287015190505b611f668582611ee8565b865550611fce565b601f198416611f7c86611d58565b60005b82811015611fa457848901518255600182019150602085019450602081019050611f7f565b86831015611fc15784890151611fbd601f891682611eca565b8355505b6001600288020188555050505b50505050505056fea26469706673582212204febfa14a25d05c9106eb57eebb008baa47395313ebc0af173934efe62d610ea64736f6c63430008110033'
Manager = web3.eth.contract(abi=abi,bytecode=bytecode)

tx_hash=Manager.constructor().transact()
print(tx_hash)

tx_receipt = web3.eth.waitForTransactionReceipt(tx_hash)

contract=web3.eth.contract(
    address=tx_receipt.contractAddress,
    abi=abi
)

def DoctorRegistration(did,d_name):
    tx_hash = contract.functions.DoctorRegistration(did,d_name).transact()

def PatientRegistration(pid,p_name,slipno):
    tx_hash=contract.functions.PatientRegistration(pid,p_name,slipno).transact()

def MedicalCertificate(slipid,cid,did,dname,pid,pname,date,address1) :
    tx_hash=contract.functions.MedicalCertificate(slipid,cid,did,dname,pid,pname,date,address1).transact()

def Check1(cid):
     return contract.functions.Check1(cid).call()

def  Check2(cid):
    return contract.functions.Check2(cid).call()

def  Check3(slipid):
    tx_hash = contract.functions.Check3(slipid).transact()
    return contract.functions.Check3(slipid).call()
